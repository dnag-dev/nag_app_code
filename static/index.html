
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nag - The Digital Twin (Debug Mode)</title>
</head>
<body>
  <h1>Welcome to Nag (Debug Mode)</h1>
  <p>The digital extension of Dinakara’s mind — therapist, companion, unfiltered mirror.</p>
  <input type="text" id="userInput" placeholder="Ask Nag something..." />
  <button onclick="sendMessage()">Send</button>
  <p id="nagText"></p>
  <pre id="debugLog" style="background: #eee; padding: 10px;"></pre>
  <audio id="nagAudio" controls style="display:none;"></audio>

  <script>
    async function sendMessage() {
      const input = document.getElementById("userInput").value;
      const response = await fetch("/chat", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message: input })
      });

      const result = await response.json();
      const debugLog = document.getElementById("debugLog");
      debugLog.textContent = JSON.stringify(result.debug || result.error || {}, null, 2);

      if (response.ok) {
        document.getElementById("nagText").textContent = result.response;
        const audio = document.getElementById("nagAudio");
        audio.src = result.audio_url;
        audio.style.display = "block";
        audio.play();
      } else {
        alert(result.error || "Something went wrong");
      }
    }
  </script>
</body>
</html>
